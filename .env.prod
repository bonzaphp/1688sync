# 1688sync 生产环境配置

# 基础配置
DEBUG=false
LOG_LEVEL=WARNING
ENVIRONMENT=production

# 数据库配置
MYSQL_ROOT_PASSWORD=CHANGE_THIS_STRONG_PASSWORD_1688sync
DATABASE_URL=mysql+pymysql://root:CHANGE_THIS_STRONG_PASSWORD_1688sync@mysql:3306/1688sync

# Redis配置
REDIS_URL=redis://redis:6379/0

# API服务配置
API_HOST=0.0.0.0
API_PORT=8000
API_DEBUG=false

# Celery配置
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/1
CELERY_WORKER_CONCURRENCY=8
CELERY_WORKER_PREFETCH_MULTIPLIER=1
CELERY_TASK_TIME_LIMIT=1800
CELERY_TASK_SOFT_TIME_LIMIT=1500
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000

# 安全配置
SECRET_KEY=CHANGE_THIS_SUPER_SECRET_KEY_IN_PRODUCTION
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15

# 文件存储配置
DATA_DIR=/app/data
IMAGE_DIR=/app/data/images
LOG_FILE=/app/logs/1688sync.log
STORAGE_PATH=/app/images
MAX_FILE_SIZE=10485760
CDN_BASE_URL=
CDN_ENABLED=false

# 队列配置
CELERY_DEFAULT_QUEUE=default
CELERY_QUEUES=default,crawler,image_processing,data_sync,batch_processing
CELERY_ROUTES_ENABLED=true
CELERY_SEND_TASK_EVENTS=true
CELERY_TASK_TRACK_STARTED=true

# 检查点配置
CHECKPOINT_DIR=/app/checkpoints
CHECKPOINT_MAX_PER_TASK=100
CHECKPOINT_AUTO_SAVE=true

# 恢复配置
RECOVERY_MAX_RETRIES=5
RECOVERY_RETRY_DELAY=60
RECOVERY_BACKOFF_FACTOR=2.0
RECOVERY_MAX_RETRY_DELAY=3600

# 并发配置
MAX_CONCURRENT_REQUESTS=200
REQUEST_TIMEOUT=30

# Scrapy配置
SCRAPY_USER_AGENT=1688sync/1.0
SCRAPY_CONCURRENT_REQUESTS=16
SCRAPY_DOWNLOAD_DELAY=1.0
SCRAPY_RANDOMIZE_DOWNLOAD_DELAY=true

# 监控配置
METRICS_ENABLED=true
SENTRY_DSN=https://your-sentry-dsn-here

# 数据同步配置
BATCH_SIZE=1000
SYNC_INTERVAL=300
RETRY_ATTEMPTS=5
RETRY_DELAY=10

# 生产特定配置
AUTO_RELOAD=false
DEBUG_SQL=false
SHOW_SQL_QUERIES=false

# Grafana配置
GRAFANA_PASSWORD=CHANGE_THIS_GRAFANA_PASSWORD

# 性能优化
WORKER_CONNECTIONS=1000
KEEPALIVE_TIMEOUT=65
MAX_CLIENT_BODY_SIZE=50M

# 安全增强
FORCE_HTTPS=true
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60